{"version":3,"sources":["../../src/cli/update.js"],"names":["module","exports","version","modulesManager","packages","listInstalled","cmdRest","pkg","confirm","Confirm","chalk","run","length","console","log","fs","existsSync","path","resolve"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AAEA;;AACA;;;;;;;;AAEAA,OAAOC,OAAP;AAAA,+BAAiB,WAAMC,OAAN,EAAiB;AAChCA,cAAUA,WAAW,QAArB;;AAEA,UAAMC,iBAAiB,uBAAc,IAAd,EAAoB,IAApB,EAA0B,IAA1B,CAAvB;AACA,UAAMC,WAAW,CAAC,UAAD,EAAa,GAAGD,eAAeE,aAAf,EAAhB,CAAjB;;AAEA,QAAIC,UAAU,EAAd;;AAEA,SAAK,MAAMC,GAAX,IAAkBH,QAAlB,EAA4B;AAC1B,YAAMI,UAAU,MAAM,IAAIC,uBAAJ,CAAYC,eAAM;iCACXH,GAAI,4BAA2BL,OAAQ,IAD9C,EACmDS,GADnD,EAAtB;AAEA,UAAIH,OAAJ,EAAa;AACXF,mBAAY,GAAEC,GAAI,IAAGL,OAAQ,GAA7B;AACD;AACF;;AAED,QAAII,QAAQM,MAAZ,EAAoB;AAClBC,cAAQC,GAAR,CAAYJ,eAAM,0DAAlB;;AAEA,UAAIK,aAAGC,UAAH,CAAcC,eAAKC,OAAL,CAAa,aAAb,CAAd,CAAJ,EAAgD;AAC9C,qCAAU,YAAWZ,OAAQ,EAA7B;AACD,OAFD,MAEO;AACL,qCAAU,sBAAqBA,OAAQ,EAAvC;AACD;;AAEDO,cAAQC,GAAR,CAAYJ,eAAM,oBAAlB;AACD;AACF,GA3BD;;AAAA;AAAA;AAAA;AAAA","file":"update.js","sourcesContent":["import Confirm from 'prompt-confirm'\nimport chalk from 'chalk'\nimport path from 'path'\nimport fs from 'fs'\nimport { execSync } from 'child_process'\n\nimport { print } from '../util'\nimport createModules from '../modules'\n\nmodule.exports = async version => {\n  version = version || 'latest'\n\n  const modulesManager = createModules(null, './', null)\n  const packages = ['botpress', ...modulesManager.listInstalled()]\n\n  let cmdRest = ''\n\n  for (const pkg of packages) {\n    const confirm = await new Confirm(chalk`\nDo you want to update {yellow \"${pkg}\"} to version {underline ${version}}?`).run()\n    if (confirm) {\n      cmdRest += `${pkg}@${version} `\n    }\n  }\n\n  if (cmdRest.length) {\n    console.log(chalk`===> {underline Installing dependencies, please wait...}`)\n\n    if (fs.existsSync(path.resolve('./yarn.lock'))) {\n      execSync(`yarn add ${cmdRest}`)\n    } else {\n      execSync(`npm install --save ${cmdRest}`)\n    }\n\n    console.log(chalk`{green.bold Done!}`)\n  }\n}\n"]}