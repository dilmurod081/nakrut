{"version":3,"sources":["../../src/media-manager/index.js"],"names":["defaultDir","module","exports","botfile","logger","ghostManager","projectLocation","mediaDir","path","resolve","addRootFolder","isBinary","saveFile","filename","buffer","basename","upsertFile","readFile"],"mappings":";;AAAA;;;;AACA;;;;;;AAEA,MAAMA,aAAa,SAAnB;;AAEAC,OAAOC,OAAP,GAAiB,CAAC,EAAEC,OAAF,EAAWC,MAAX,EAAmBC,YAAnB,EAAiCC,eAAjC,EAAD,KAAwD;AACvE,QAAMC,WAAWC,eAAKC,OAAL,CAAaH,eAAb,EAA8BH,QAAQI,QAAR,IAAoBP,UAAlD,CAAjB;;AAEAK,eAAaK,aAAb,CAA2BH,QAA3B,EAAqC,EAAEI,UAAU,IAAZ,EAArC;;AAEA,QAAMC;AAAA,iCAAW,WAAOC,QAAP,EAAiBC,MAAjB,EAA4B;AAC3CD,iBAAY,GAAE,kBAAO,EAAP,CAAW,IAAGL,eAAKO,QAAL,CAAcF,QAAd,CAAwB,EAApD;AACA,YAAMR,aAAaW,UAAb,CAAwBT,QAAxB,EAAkCM,QAAlC,EAA4CC,MAA5C,CAAN;AACA,aAAOD,QAAP;AACD,KAJK;;AAAA;AAAA;AAAA;AAAA,MAAN;;AAMA,QAAMI,WAAWJ,YAAYR,aAAaY,QAAb,CAAsBV,QAAtB,EAAgCM,QAAhC,CAA7B;;AAEA,SAAO,EAAED,QAAF,EAAYK,QAAZ,EAAP;AACD,CAdD","file":"index.js","sourcesContent":["import path from 'path'\nimport { safeId } from '../util'\n\nconst defaultDir = './media'\n\nmodule.exports = ({ botfile, logger, ghostManager, projectLocation }) => {\n  const mediaDir = path.resolve(projectLocation, botfile.mediaDir || defaultDir)\n\n  ghostManager.addRootFolder(mediaDir, { isBinary: true })\n\n  const saveFile = async (filename, buffer) => {\n    filename = `${safeId(20)}-${path.basename(filename)}`\n    await ghostManager.upsertFile(mediaDir, filename, buffer)\n    return filename\n  }\n\n  const readFile = filename => ghostManager.readFile(mediaDir, filename)\n\n  return { saveFile, readFile }\n}\n"]}