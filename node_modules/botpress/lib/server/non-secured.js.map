{"version":3,"sources":["../../src/server/non-secured.js"],"names":["module","exports","bp","app","get","req","res","send","licensing","getLicensing","delete","fs","unlink","path","join","projectLocation","isFirstRun","sendStatus","roles","cloud","getUserRoles","user"],"mappings":";;;;AAAA;;;;AACA;;;;AAEA;;;;;;;;AAEAA,OAAOC,OAAP,GAAiB,CAACC,EAAD,EAAKC,GAAL,KAAa;AAC5BA,MAAIC,GAAJ,CAAQ,WAAR,EAAqB,CAACC,GAAD,EAAMC,GAAN,KAAc;AACjCA,QAAIC,IAAJ,CAAS,MAAT;AACD,GAFD;;AAIAJ,MAAIC,GAAJ,CAAQ,cAAR;AAAA,iCAAwB,WAAOC,GAAP,EAAYC,GAAZ,EAAoB;AAC1CA,UAAIC,IAAJ,EAAS,MAAML,GAAGM,SAAH,CAAaC,YAAb,EAAf;AACD,KAFD;;AAAA;AAAA;AAAA;AAAA;;AAIAN,MAAIO,MAAJ,CAAW,kBAAX,EAA+B,CAACL,GAAD,EAAMC,GAAN,KAAc;AAC3CK,iBAAGC,MAAH,CAAUC,eAAKC,IAAL,CAAUZ,GAAGa,eAAb,EAA8B,UAA9B,CAAV,EAAqD,MAAM;AACzDb,SAAGc,UAAH,GAAgB,KAAhB;AACAV,UAAIW,UAAJ,CAAe,GAAf;AACD,KAHD;AAID,GALD;;AAOAd,MAAIC,GAAJ,CAAQ,iBAAR;AAAA,kCAA2B,WAAOC,GAAP,EAAYC,GAAZ,EAAoB;AAC7C,YAAMY,QAAQ,MAAMhB,GAAGiB,KAAH,CAASC,YAAT,CAAsBf,IAAIgB,IAAJ,CAASH,KAA/B,CAApB;AACAZ,UAAIC,IAAJ,cAAcF,IAAIgB,IAAlB,IAAwBH,KAAxB;AACD,KAHD;;AAAA;AAAA;AAAA;AAAA;AAID,CApBD","file":"non-secured.js","sourcesContent":["import fs from 'fs'\nimport path from 'path'\n\nimport util from '../util'\n\nmodule.exports = (bp, app) => {\n  app.get('/api/ping', (req, res) => {\n    res.send('pong')\n  })\n\n  app.get('/api/license', async (req, res) => {\n    res.send(await bp.licensing.getLicensing())\n  })\n\n  app.delete('/api/guided-tour', (req, res) => {\n    fs.unlink(path.join(bp.projectLocation, '.welcome'), () => {\n      bp.isFirstRun = false\n      res.sendStatus(200)\n    })\n  })\n\n  app.get('/api/my-account', async (req, res) => {\n    const roles = await bp.cloud.getUserRoles(req.user.roles)\n    res.send({ ...req.user, roles })\n  })\n}\n"]}